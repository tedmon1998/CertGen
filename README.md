# Генератор сертификатов

Программа для автоматической генерации сертификатов с наложением ФИО участников на шаблон.

## Возможности

- Загрузка шаблона сертификата (PNG, JPG, JPEG, BMP, GIF)
- Загрузка Excel (.xlsx, .xls) или CSV файла с ФИО участников
- **Живой предварительный просмотр** - текст отображается прямо на изображении в реальном времени
- **Область для текста** - укажите прямоугольную область для размещения ФИО
- **Интерактивное редактирование** - перетаскивайте область как в Figma
- **Два инструмента** - move (перемещение) и resize (изменение размера)
- **Плавное перетаскивание** - мгновенное обновление без задержек
- **Вертикальная прокрутка** - удобная навигация по настройкам
- **Ползунки для всех параметров** - размер шрифта, отступы, позиционирование
- **Настройка отступов** - регулируйте отступы текста внутри области
- **Настройка размеров окна** - возможность изменять ширину и высоту окна
- **Настройка ширины панели** - регулировка ширины панели настроек  
- **Сохранение размеров** - все размеры сохраняются в настройках проекта
- **Визуальные границы** - разные цвета для области и отступов
- **Автоматический перенос строк** - текст автоматически переносится на новую строку
- **Настройка межстрочного интервала** - регулируйте расстояние между строками
- **Интерактивное позиционирование** - кликните на изображении, чтобы установить область для текста
- **Выбор шрифтов** - используйте системные шрифты или загружайте собственные файлы шрифтов (.ttf, .otf)
- **Граница вокруг изображения** - четко видно границы сертификата даже на белом фоне
- Настройка размера и цвета шрифта с мгновенным обновлением
- Отображение координат мыши в реальном времени
- Автоматическая генерация сертификатов для всех участников

## Установка

1. Установите Python 3.7 или выше
2. Установите зависимости:
```bash
pip install -r requirements.txt
```

## Использование

1. Запустите программу:
```bash
python certificate_generator.py
```

2. **Выберите шаблон сертификата** - изображение автоматически отобразится в правой панели
3. **Выберите Excel (.xlsx) или CSV файл** с ФИО участников
4. **Папка для сохранения** создается автоматически с именем дата-время-сертификаты
5. **Настройте область для текста:**
   - Выберите режим: "area" (область) или "point" (точка)
   - **По умолчанию**: инструмент "resize" (изменение размера)
   - **Точное позиционирование**: используйте ползунки X и Y для пиксельного перемещения
   - **Размер области**: используйте ползунки "Ширина" и "Высота"
   - **Отступы текста**: настройте отступы слева, справа, сверху и снизу (0-50 пикселей)
   - Перетаскивайте область для перемещения (зеленая рамка)
   - Тяните за красные углы для изменения размера (красная рамка)
   - Синяя рамка показывает область для текста с учетом отступов
   - Выберите выравнивание: left, center, right
6. **Настройте внешний вид:**
   - Введите тестовый текст для предварительного просмотра
   - Выберите шрифт из списка системных шрифтов
   - Или загрузите собственный файл шрифта (.ttf, .otf)
   - **Размер шрифта**: используйте ползунок (10-200)
   - Измените цвет шрифта (формат #000000)
   - **Межстрочный интервал**: используйте ползунок (0-50 пикселей)
7. **Настройте размеры окна:**
   - **Ширина окна**: используйте ползунок (800-2000 пикселей)
   - **Высота окна**: используйте ползунок (600-1200 пикселей)  
   - **Ширина панели**: используйте ползунок (300-800 пикселей)
8. **Сохраните проект (опционально):**
   - Нажмите "Сохранить настройки" для сохранения проекта в JSON файл
   - Позже можете загрузить настройки кнопкой "Загрузить настройки"
9. **Проверьте результат** - текст будет отображаться на изображении в реальном времени
10. **Нажмите "Генерировать сертификаты"** для создания всех сертификатов

## Формат файла с данными

Программа поддерживает как Excel (.xlsx, .xls), так и CSV файлы. Файл должен содержать колонку с ФИО участников.

### Требования к файлу:
Программа ищет **только колонку с точным названием "ФИО"**. Все остальные колонки игнорируются.

**Важно:** Название колонки должно быть точно "ФИО" (без пробелов, лишних символов).

### Пример CSV файла (example_participants.csv):
```csv
ФИО,Должность,Компания
Иванов Иван Иванович,Директор,ООО "Технологии"
Петров Петр Петрович,Заместитель директора,ООО "Инновации"
Сидоров Сидор Сидорович,Менеджер,ИП Сидоров
Козлова Анна Владимировна,Специалист,ООО "Сервис"
Морозов Дмитрий Александрович,Аналитик,ООО "Разработка"
```

**Примечание:** Колонки "Должность" и "Компания" игнорируются. Используется только колонка "ФИО".

### Упрощенный пример (example_simple.csv):
```csv
ФИО
Иванов Иван Иванович
Петров Петр Петрович
Сидоров Сидор Сидорович
Козлова Анна Владимировна
Морозов Дмитрий Александрович
```

### Результат генерации:
- certificate_1_Иванов Иван Иванович.png
- certificate_2_Петров Петр Петрович.png
- certificate_3_Сидоров Сидор Сидорович.png
- certificate_4_Козлова Анна Владимировна.png
- certificate_5_Морозов Дмитрий Александрович.png

## Особенности

- **Автоматическое создание папки**: Папка создается с именем в формате "YYYY-MM-DD_HH-MM-SS_сертификаты"
- **Граница сертификата**: Автоматически добавляется серая граница для лучшей видимости
- **Поддержка CSV**: Можно использовать простые CSV файлы вместо Excel
- **Кодировка**: CSV файлы должны быть в кодировке UTF-8
- **Удобство**: Не нужно выбирать папку - все создается автоматически

## Сохранение и загрузка проектов

Программа позволяет сохранять все настройки проекта в JSON файл для продолжения работы позже.

### Что сохраняется:
- Пути к файлам (шаблон, Excel/CSV, папка сохранения)
- Все настройки текста (позиция, размер, цвет, шрифт)
- Область для размещения ФИО
- Выравнивание и межстрочный интервал
- Список доступных шрифтов
- Режим работы (area/point, move/resize)

### Как использовать:
1. **Настройте проект** - выберите файлы и настройте параметры
2. **Сохраните настройки** - нажмите "Сохранить настройки"
3. **Выберите место сохранения** - укажите имя JSON файла
4. **Позже загрузите проект** - нажмите "Загрузить настройки"
5. **Выберите JSON файл** - все настройки восстановятся

### Пример JSON файла:
```json
{
  "template_path": "C:/path/to/template.png",
  "excel_path": "C:/path/to/participants.xlsx",
  "text_mode": "area",
  "tool_mode": "move",
  "text_alignment": "center",
  "text_area_x1": 300,
  "text_area_y1": 250,
  "text_area_x2": 500,
  "text_area_y2": 350,
  "font_size": 50,
  "font_color": "#000000",
  "selected_font": "Arial",
  "line_spacing": 5
}
```
